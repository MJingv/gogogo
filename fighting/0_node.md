pm2功能

- 进程守护：意外崩溃or退出时自动重启
- 多进程管理：根据配置启动多个进程处理请求
- 日志管理
- 监控和指标
- 部署和更新
- 环境变量管理
- 远程操作

pm2原理

- 进程管理，用cluster模拟实现多进程管理，启动多个子进程处理请求，每个子进程都是一个独立的nodejs进程，共享一个端口，通过负载均衡算法将请求分发给不同子进程
- 进程守护，
- 日志管理，pm2将日志输入到文件，使用stream模块实现日志写入和轮转
- 监控和指标，使用nodejs的process模块和操作系统的pai获取cpu使用率、内存占用等指标

pm进程管理原理
- pm2在子进程启动时，为每个子进程创建一个监控器。监控器定期向子进程发送心跳信号，在一段时间内没有收到子进程的心跳，会判断子进程异常退出，出发重启
- 进程管理、日志管理、监控报警等







